
   
    <a href="/">Retour √† l'accueil</a>
    <hr>

    <h3>1. Base de donn√©es</h3>
    <form id="form-init" action="{{ url_for('synchro.initialisation') }}" method="POST">
        <button type="submit">Initialiser la BDD</button>
    </form>

    {% if msg_db %}
        <p style="color: blue;"><strong>{{ msg_db }}</strong></p>
    {% endif %}

    <hr>

    <h3>2. Import des donn√©es</h3>
    <form id="form-sync" action="{{ url_for('synchro.synchronisation') }}" method="POST">
        <button type="submit">Synchroniser les donn√©es</button>
    </form>

    {% if msg_import %}
        <p style="color: green;"><strong>{{ msg_import }}</strong></p>
    {% endif %}

    {% if stats %}
    <div style="background-color: #f8f9fa; padding: 15px; border: 1px solid #ddd; border-radius: 5px; margin-top: 20px;">
        <h4>üìä Bilan de la synchronisation ScoDoc</h4>
        <ul>
            <li>D√©partements trait√©s : <strong>{{ stats.departements }}</strong></li>
            <li>Formations import√©es : <strong>{{ stats.formations }}</strong></li>
            <li>√âtudiants mis √† jour : <strong>{{ stats.etudiants }}</strong></li>
            <li>Inscriptions (Ann√©es) : <strong>{{ stats.inscriptions }}</strong></li>
            <li>Evaluations (Notes) : <strong>{{ stats.evaluations }}</strong></li>
        </ul>
        {% if stats.competences is defined %}
            <p>Comp√©tences import√©es : <strong>{{ stats.competences }}</strong></p>
        {% endif %}
    </div>
    {% endif %}


    <script>
            document.getElementById('form-init').addEventListener('submit', function(event) {
            // Affiche le pop-up
            const choix = confirm("ATTENTION : Cette action va SUPPRIMER toutes les donn√©es existantes et recr√©er les tables vides.\n\n√ätes-vous s√ªr de vouloir continuer ?");
            
            // Si l'utilisateur clique sur "Annuler"
            if (!choix) {
                event.preventDefault(); // On bloque l'envoi du formulaire
            }
            // Sinon, le formulaire part normalement
            });

            document.getElementById('form-sync').addEventListener('click', function() {
            
            // Affiche le pop-up
            const choix = confirm("Voulez-vous lancer la synchronisation des donn√©es depuis les fichiers JSON ?");

            // Si l'utilisateur clique sur "Annuler", on arr√™te tout ici
            if (!choix) {
                event.preventDefault(); 
            }
            });
    </script>
